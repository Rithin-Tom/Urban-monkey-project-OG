(()=>{window.zecpeMainScriptUrl="https://cdn.zecpe.com/checkout/build/script.js",window.zecpeHostName="https://api-v2.zecpe.com",window.zecpeScriptType="module",("tablecamp.myshopify.com"!==window.storeShopifyDomain&&"gcf-test-101.myshopify.com"!==window.storeShopifyDomain||"Staging"!==window.storeThemeName)&&"flits-support-workplace-11.myshopify.com"!==window.storeShopifyDomain&&"ecom360-cf.myshopify.com"!==window.storeShopifyDomain&&"belavitaorganic-com.myshopify.com"!==window.storeShopifyDomain&&"gw0kx6-ix.myshopify.com"!==window.storeShopifyDomain&&"gxwptz-pp.myshopify.com"!==window.storeShopifyDomain||(window.zecpeHostName="https://staging.api.zecpe.com",window.zecpeMainScriptUrl="https://staging.checkout.zecpe.com/build/script.js",window.zecpeScriptType="module");let ignoredErrors=["Cannot assign to read only property 'src' of object"];try{["touchstart","touchmove","touchend","touchcancel"].forEach(event=>{document.addEventListener(event,e=>{window.isZecpeCheckoutInitiated&&(e.stopPropagation(),e.stopImmediatePropagation())},!0),window.addEventListener(event,e=>{window.isZecpeCheckoutInitiated&&(e.stopPropagation(),e.stopImmediatePropagation())},!0)})}catch(err){triggerSentry("Error in adding touchmove event listener :: "+err?.message)}window.isLocalStorageSupported=(()=>{let localStorageSupported=null;return()=>{if(null===localStorageSupported)try{localStorage.setItem("occ-localStorage-check","check"),localStorage.getItem("occ-localStorage-check"),localStorage.removeItem("occ-localStorage-check"),localStorageSupported=!0}catch(error){localStorageSupported=!1}return localStorageSupported}})(),window.convertToObject=obj=>{try{var key,keyName,keyValue,newObj={};for(key in obj)key.includes("[")&&key.includes("]")?(keyName=key.split("[")[0],keyValue=key.split("[")[1].split("]")[0],keyName in newObj||(newObj[keyName]=new Object),newObj[keyName][keyValue]=obj[key]):newObj[key]=obj[key];return newObj}catch(err){triggerSentry("Error in convertToObject :: "+err?.message)}},window.RetrieveCart=async()=>{try{var data,cartItems=JSON.parse(localStorage.getItem("occ-old-cart"));cartItems?.items?.length&&(await fetch(window.location.origin+"/cart/clear.js",{method:"POST"}),(data={items:cartItems.items}).items)&&data.items.length&&fetch(window.location.origin+"/cart/add.js",{method:"POST",body:JSON.stringify(data),headers:{"Content-Type":"application/json"}})}catch(err){console.log(err)}},window.handleAbandonedRedirect=async productsArray=>{try{if(0<(productsArray=productsArray.filter(product=>product.id&&product.quantity&&"number"==typeof product.id&&"number"==typeof product.quantity)).length){window.addEventListener("DOMContentLoaded",event=>{var zecpeOverlay;document.getElementById("zecpe-overlay")||((zecpeOverlay=document.createElement("div")).setAttribute("id","zecpe-overlay"),zecpeOverlay.innerHTML=`
                       <div style="text-align : center">
                       <div id="occ-payment-loader-container">
                       <div id="occ-payment-loader">&nbsp;</div>
                       </div>
                         <br />
                         <p style="font-size: 18px; color : #000">Please wait while we fetch your cart.</p>
                     </div>`,document.body.appendChild(zecpeOverlay),document.body.style.overFlow="hidden")});let cart=await fetch(window.location.origin+"/cart.js",{method:"GET",headers:{"Content-Type":"application/json"}}),cartSaveResponse=(cart=await cart.json(),localStorage.setItem("occ-old-cart",JSON.stringify(cart)),await fetch(window.location.origin+"/cart/clear.js",{method:"POST"}),await fetch(window.location.origin+"/cart/add.js",{method:"POST",body:JSON.stringify({items:productsArray}),headers:{"Content-Type":"application/json"}}));if(!(cartSaveResponse=await cartSaveResponse.json())||!cartSaveResponse.items?.length)throw new Error("Invalid cart details");handleOcc(null,!0)}}catch(err){document.body.style.overFlow="auto",document.getElementById("zecpe-overlay")&&document.getElementById("zecpe-overlay").remove(),"Invalid cart details"===err?.message?window.location.replace(window.location.origin):RetrieveCart()}},window.handleOcc=async(element=!1,retrieveCartBoolean=!1,formElement)=>{try{window.isLocalStorageSupported()?(element&&element.children&&(2===Array.from(element.children).length&&(Array.from(element.children)[0].style.display="grid",Array.from(element.children)[1].style.display="none"),element.disabled=!0,element.style.cursor="not-allowed",setTimeout(()=>{2===Array.from(element.children).length&&(Array.from(element.children)[0].style.display="none",Array.from(element.children)[1].style.display="flex"),element.removeAttribute("disabled"),element.style.cursor="pointer"},6e3)),await LoadOccScript(retrieveCartBoolean,formElement)):zecpeRedirectToShopify(retrieveCartBoolean,formElement)}catch(err){triggerSentry("handleOcc function error :: "+err?.message),redirectToShopify(retrieveCartBoolean,formElement)}},window.HandleBuyNowZecpe=async(element,formElement=null)=>{try{if(window.isLocalStorageSupported()){element&&element.children&&(2===Array.from(element.children).length&&(Array.from(element.children)[0].style.display="grid",Array.from(element.children)[1].style.display="none"),element.disabled=!0,element.style.cursor="not-allowed",setTimeout(()=>{2===Array.from(element.children).length&&(Array.from(element.children)[0].style.display="none",Array.from(element.children)[1].style.display="flex"),element.removeAttribute("disabled"),element.style.cursor="pointer"},6e3));let cart=await fetch(window.location.origin+"/cart.js",{method:"GET",headers:{"Content-Type":"application/json"}});cart=await cart.json(),localStorage.setItem("occ-old-cart",JSON.stringify(cart));var productForm=formElement||document.querySelector('form[action$="/cart/add"]');if(productForm){var formEntries=new FormData(productForm).entries();let formObject=new Object;if(formEntries){for(var entry of formEntries)formObject[entry[0]]=entry[1];cart?.items?.length&&await fetch(window.location.origin+"/cart/clear.js",{method:"POST"}),formObject=convertToObject(formObject);var quantityInput=productForm.querySelector("input.quantity__input")?.value||productForm.querySelector("input[name='quantity']")?.value||element.closest("input.quantity__input")||element.closest("input[name='quantity']")||1;formObject.quantity||(formObject.quantity=parseInt(quantityInput)),await fetch(window.location.origin+"/cart/add.js",{method:"POST",body:JSON.stringify(formObject),headers:{"Content-Type":"application/json"}}),handleOcc(null,!0,productForm)}}}else zecpeRedirectToShopify(!0,formElement||document.querySelector('form[action$="/cart/add"]'))}catch(err){zecpeRedirectToShopify(!0,formElement||document.querySelector('form[action$="/cart/add"]'))}},window.zecpeRedirectToShopify=(checkoutInitiatedByBuyNow,formElement)=>{try{if(checkoutInitiatedByBuyNow){let variantId,quantity=1;if(formElement&&formElement instanceof HTMLElement){var formEntries=new FormData(formElement).entries(),formObject=new Object;if(formEntries)for(var entry of formEntries)formObject[entry[0]]=entry[1];formObject.id&&(variantId=formObject.id),formObject.quantity&&(quantity=formObject.quantity),variantId&&quantity?window.location.href=`/cart/${variantId}:`+quantity:window.location.href="/cart"}}else window.location.href="/cart/checkout"}catch(err){triggerSentry("zecpeRedirectToShopify function error :: "+err?.message),window.location.href="/cart/checkout"}},window.isCheckoutInitiatedByBuyNow=()=>{try{var zecpeBtns=document.getElementsByClassName("zecpe-btn");if(zecpeBtns)for(let i=0;i<zecpeBtns.length;i++)if(2===Array.from(zecpeBtns[i].children).length)return!("flex"!==Array.from(zecpeBtns[i].children)[0].style.display&&"grid"!==Array.from(zecpeBtns[i].children)[0].style.display||!["buy now","buy it now"].includes(Array.from(zecpeBtns[i].children)[1]?.innerText?.toLowerCase().trim()));return!1}catch(err){return triggerSentry("isCheckoutInitiatedByBuyNow function error :: "+err?.message),!1}},window.LoadOccScript=async(retrieveCartBoolean=!1,formElement)=>new Promise(async(resolve,reject)=>{try{let requestController=new AbortController;setTimeout(()=>requestController.abort(),4e3);var promiseArray=[fetch(window.location.origin+"/cart.js",{signal:requestController.signal}),fetch(window.zecpeHostName+"/api/stores/theme/"+(window.Shopify&&window.Shopify.shop),{signal:requestController.signal})];let[cart,theme]=await Promise.allSettled(promiseArray);var handleSentryAndRedirection=(cart,theme)=>{let error;"rejected"===theme?.status&&"rejected"===cart?.status?error=cart?.reason?.message||theme?.reason?.message:"rejected"===theme?.status?error=theme?.reason?.message:"rejected"===cart?.status&&(error=cart?.reason?.message),zecpeRedirectToShopify(isCheckoutInitiatedByBuyNow(),formElement)};if("fulfilled"!==theme?.status||"fulfilled"!==cart?.status)handleSentryAndRedirection(cart,theme);else if([cart,theme]=await Promise.allSettled([cart.value.json(),theme.value.json()]),"fulfilled"!==theme?.status||"fulfilled"!==cart?.status)handleSentryAndRedirection(cart,theme);else{try{let controller=new AbortController,countryData=(setTimeout(()=>controller.abort(),2e3),await fetch(window?.Shopify?.routes?.root+"browsing_context_suggestions.json?country[enabled]=true&country[exclude]="+window?.Shopify?.country+"&language[enabled]=true&language[exclude]="+window?.Shopify?.language,{method:"GET",headers:{"Content-Type":"application/json"},signal:controller.signal}).catch(err=>{console.log("Error in fetching country data :: ",err)}));if(countryData&&200===countryData.status)if("India"!==(countryData=await countryData.json())?.detected_values?.country?.name)return void zecpeRedirectToShopify(isCheckoutInitiatedByBuyNow(),formElement)}catch(err){console.log("Error in fetching country data :: ",err)}if(theme=theme.value,cart=cart.value,theme.data&&theme.data.result&&(localStorage.setItem("occ-theme",JSON.stringify(theme.data.result)),retrieveCartBoolean&&!theme?.data?.result?.redirectToShopify&&RetrieveCart(),theme?.data?.result?.redirectToShopify))zecpeRedirectToShopify(isCheckoutInitiatedByBuyNow(),formElement);else{var data=cart;if(window.Zecpe||(window.Zecpe={}),window.Zecpe.cart=data,window.Zecpe.cart.items&&window.Zecpe.cart.items.length){var shopifyCustomerId=window?._st?.cid||window?.ShopifyAnalytics?.meta?.page?.customerId,scripts=(shopifyCustomerId&&(window.Zecpe.cart.customerId=shopifyCustomerId),localStorage.setItem("occ-cart",JSON.stringify(window.Zecpe.cart)),document.querySelectorAll("script"));if(Array.from(scripts).find(script=>script.src&&script.src.includes(window.zecpeMainScriptUrl))&&"function"==typeof window?.Occ?.RunScript)return Occ.RunScript(),resolve({message:"Success"});{let script=document.createElement("script");script.type=window.zecpeScriptType,script.src=window.zecpeMainScriptUrl,document.head.appendChild(script),script.addEventListener("load",()=>(Occ.RunScript(),resolve({message:"Success"})))}}else window.location.reload()}}}catch(err){reject(err)}});try{let zecpeScriptLoaded=!1;!function loadScriptWithRetries(url,retries){var script;retries<=0||zecpeScriptLoaded||window.zecpeScriptLoaded||"function"==typeof window?.Occ?.RunScript||((script=document.createElement("script")).type=window.zecpeScriptType,script.src=url,script.async=!0,script.onload=function(){zecpeScriptLoaded=!0,window.zecpeScriptLoaded=!0},document.head.appendChild(script),setTimeout(function(){loadScriptWithRetries(url,retries-1)},2e3))}(window.zecpeMainScriptUrl,3);var link=document.createElement("link");link.rel="dns-prefetch",link.href=window.zecpeHostName,link.fetchpriority="high",document.head&&document.head.appendChild(link)}catch(err){triggerSentry("loadZecpeScript function error :: "+err?.message)}try{if(window.isLocalStorageSupported()){var querystring=window.location.href.split("?"),utmParameters=new Object;let productsArray,initiatedByZecpe=!1;var zecpeAcceptedParams=["utm_source","utm_campaign","utm_medium","utm_content","utm_term","fbclid","gclid","products","initiated_by"];if(1<querystring.length){var i,keyval,pairs=querystring[1].split("&");for(i in pairs)"string"==typeof pairs[i]&&"function"==typeof pairs[i].split&&(keyval=pairs[i].split("="),zecpeAcceptedParams.includes(keyval[0]))&&("products"===keyval[0]?productsArray=keyval[1].split(",")?.map(product=>{var quantity;return product&&product.split(":")&&2==product.split(":").length?([product,quantity]=product.split(":"),{id:parseInt(product),quantity:parseInt(quantity)}):{}}):"initiated_by"===keyval[0]&&"zecpe"===keyval[1]?initiatedByZecpe=!0:keyval[0].startsWith("utm")&&(keyval[0]=keyval[0].split("_")[1]),utmParameters[keyval[0]]=decodeURIComponent(keyval[1]))}var utmParmsObject,urlSearchParams=new URLSearchParams(window.location.search),params=Object.fromEntries(Array.from(urlSearchParams.entries()));initiatedByZecpe&&productsArray&&productsArray.length?handleAbandonedRedirect(productsArray):"zecpe"!==params?.initiated_by||params.cart||params?.cartId||handleOcc(),0!==Object.keys(utmParameters).length&&((utmParmsObject=new Object).params=utmParameters,utmParmsObject.date=new Date,localStorage.setItem("occ-utm",JSON.stringify(utmParmsObject)))}}catch(err){triggerSentry("Error in utm parameters :: "+err?.message)}window.triggerSentry=message=>{try{ignoredErrors.some(error=>!!message?.includes(error))||(message=`[theme-script] :: ${message} :: `+window.location.href,fetch(window.zecpeHostName+"/api/utils/sentry",{method:"POST",body:JSON.stringify({message:message,type:"error",sentry:!0}),headers:{"Content-Type":"application/json"}}))}catch(err){console.error("Zecpe sentry error :: "+err?.message)}}})();